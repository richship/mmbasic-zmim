' Copyright (c) 2019 Thomas Hugo Williams
' For Maximite BASIC v4.5C

Sub dmp_obj(o)
  Local ad, i, p, sz, x

  If o = 0 Then
    Print "Property defaults:"
    ad = readw(&h0A)
    For i = 0 To 30
      x = readw(ad)
      Print lpad$(Hex$(x), 4, "0"); " ";
      If (i + 1) Mod 10 = 0 Then Print
      ad = ad + 2
    Next i
    Print
    Exit Sub
  EndIf

  Print Str$(o); ". ";
  Print "Attributes: ";
  For i = 0 To 31
    x = get_attr(o, i)
    If x <> 0 Then Print i;
  Next i
  Print

  x = get_relation(o, PARENT)
  Print "   Parent object:"; x; "  ";
  x = get_relation(o, SIBLING)
  Print "Sibling object:"; x; "  ";
  x = get_relation(o, CHILD)
  Print "Child object:"; x

  ad = get_prop_base(o)
  Print "   Property address: "; lpad$(Hex$(ad), 4, "0")
  Print "        Description: '";
  print_obj(o);
  Print "'"
  Print "         Properties:"
  p = 0
  Do
    p = get_next_prop(o, p)
    If p > 0 Then
      ad = get_prop_addr(o, p)
      sz = get_prop_len(o, p)
      x = readb(ad)
      If x\32 + 1 <> sz Then Error
      Print "             ["; Str$(p); "] ";
      For i = 1 To sz
        ad = ad + 1
        x = readb(ad)
        Print lpad$(Hex$(x), 2, "0"); " ";
      Next i
      Print
    EndIf
  Loop Until p = 0
End Sub
